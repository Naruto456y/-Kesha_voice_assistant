from gtts import gTTS
import speech_recognition as sr
import pygame
import os
import time
import random
import keyboard
import webbrowser
from datetime import datetime
import AppOpener
import threading
import queue
import psutil
import os
import time
import threading
import queue
import tempfile
import pygame
import speech_recognition as sr
from gtts import gTTS
import webbrowser
import keyboard
from datetime import datetime
import psutil
import AppOpener
from ctypes import cast, POINTER
from comtypes import CLSCTX_ALL
from pycaw.pycaw import AudioUtilities, IAudioEndpointVolume
from youtube_search import YoutubeSearch
import mouse
from pydub import AudioSegment
from pydub.playback import play
import requests
from bs4 import BeautifulSoup
from urllib.parse import quote
import gig

def get_text_with_url(url, class_name):
        """
        –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞ –∏–∑ —ç–ª–µ–º–µ–Ω—Ç–∞ —Å —É–∫–∞–∑–∞–Ω–Ω—ã–º –∫–ª–∞—Å—Å–æ–º –Ω–∞ –≤–µ–±-—Å—Ç—Ä–∞–Ω–∏—Ü–µ

        Args:
        url (str): URL-–∞–¥—Ä–µ—Å —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        class_name (str): –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–ª–∞—Å—Å–∞ —ç–ª–µ–º–µ–Ω—Ç–∞

        Returns:
        str: —Ç–µ–∫—Å—Ç —ç–ª–µ–º–µ–Ω—Ç–∞ –∏–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
        """
        try:
            # –ö–æ–¥–∏—Ä—É–µ–º URL –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ä—É—Å—Å–∫–∏—Ö —Å–∏–º–≤–æ–ª–æ–≤
            encoded_url = quote(url, safe=':/?&=')
            
            # –î–æ–±–∞–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–∏ —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
            headers = {
                'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36'
            }
        
            # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å
            response = requests.get(encoded_url, headers=headers, timeout=10)
            response.raise_for_status()  # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å –æ—Ç–≤–µ—Ç–∞

            # –ü–∞—Ä—Å–∏–º HTML
            soup = BeautifulSoup(response.content, 'html.parser')

            # –ò—â–µ–º —ç–ª–µ–º–µ–Ω—Ç –ø–æ –∫–ª–∞—Å—Å—É
            element = soup.find(class_=class_name)

            if element:
                return element.text.strip()
            else:
                return f"–≠–ª–µ–º–µ–Ω—Ç —Å –∫–ª–∞—Å—Å–æ–º '{class_name}' –Ω–µ –Ω–∞–π–¥–µ–Ω"

        except requests.exceptions.RequestException as e:
            return f"–û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞: {e}"
        except Exception as e:
            return f"–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞: {e}"

def start(name, game = False):
    """–û—Ç–∫—Ä—ã–≤–∞–µ—Ç —Ñ–∞–π–ª –∏–ª–∏ –ø–∞–ø–ø–∫—É –≤ —ç—Ç–æ–π –ø–∞–ø–∫–µ"""
    path = __file__.replace('Kesha.py', name)
    os.startfile(path)

def search_and_open_youtube(query):
    """
    –ò—â–µ—Ç –≤–∏–¥–µ–æ –Ω–∞ YouTube –ø–æ –∑–∞–ø—Ä–æ—Å—É –∏ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –ø–µ—Ä–≤–æ–µ –Ω–∞–π–¥–µ–Ω–Ω–æ–µ –≤–∏–¥–µ–æ –≤ –±—Ä–∞—É–∑–µ—Ä–µ.
    
    :param query: –°—Ç—Ä–æ–∫–∞ –ø–æ–∏—Å–∫–æ–≤–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞.
    :return: None (–æ—Ç–∫—Ä—ã–≤–∞–µ—Ç —Å—Å—ã–ª–∫—É –≤ –±—Ä–∞—É–∑–µ—Ä–µ).
    """
    # –ü–æ–ª—É—á–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞
    results = YoutubeSearch(query, max_results=1).to_dict()  # –ë–µ—Ä—ë–º —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
    
    if not results:
        print("–ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ.")
        return
    
    # –§–æ—Ä–º–∏—Ä—É–µ–º –ø–æ–ª–Ω—É—é —Å—Å—ã–ª–∫—É –Ω–∞ –≤–∏–¥–µ–æ
    video_url = f"https://youtube.com{results[0]['url_suffix']}"
    
    # –û—Ç–∫—Ä—ã–≤–∞–µ–º —Å—Å—ã–ª–∫—É –≤ –±—Ä–∞—É–∑–µ—Ä–µ
    webbrowser.open(video_url)
    print(f"–û—Ç–∫—Ä—ã–≤–∞—é –≤–∏–¥–µ–æ: {results[0]['title']}")

jokes = [
# –ü—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç—Å–∫–∏–µ
"–ü–æ—á–µ–º—É –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç—ã –ø—É—Ç–∞—é—Ç –•—ç–ª–ª–æ—É–∏–Ω –∏ –†–æ–∂–¥–µ—Å—Ç–≤–æ? –ü–æ—Ç–æ–º—É —á—Ç–æ Oct 31 == Dec 25!",
"–°–∫–æ–ª—å–∫–æ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç–æ–≤ –Ω—É–∂–Ω–æ, —á—Ç–æ–±—ã –≤–∫—Ä—É—Ç–∏—Ç—å –ª–∞–º–ø–æ—á–∫—É? –ù–∏ –æ–¥–Ω–æ–≥–æ, —ç—Ç–æ hardware –ø—Ä–æ–±–ª–µ–º–∞!",
"–ü—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç –∑–≤–æ–Ω–∏—Ç –≤ —Ç–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫—É: '–£ –º–µ–Ω—è –ø—Ä–æ–±–ª–µ–º–∞...' '–†–µ—à–µ–Ω–æ', - –æ—Ç–≤–µ—á–∞—é—Ç –µ–º—É.",

# –ü—Ä–æ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤
"–°—Ç—É–¥–µ–Ω—Ç –Ω–∞ —ç–∫–∑–∞–º–µ–Ω–µ: '–Ø –∑–Ω–∞–ª –æ—Ç–≤–µ—Ç, –Ω–æ –∑–∞–±—ã–ª'. –ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å: '–ñ–∞–ª—å, —á—Ç–æ –≤—ã –Ω–µ –∑–∞–±—ã–ª–∏ –ø—Ä–∏–π—Ç–∏'",
"–õ–µ–∫—Ü–∏—è –≤ —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–µ. –ü—Ä–æ—Ñ–µ—Å—Å–æ—Ä: '–≠—Ç–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –æ—á–µ–≤–∏–¥–Ω–æ...' –°—Ç—É–¥–µ–Ω—Ç –≤—Å—Ç–∞—ë—Ç –∏ –≤—ã—Ö–æ–¥–∏—Ç: '–¢–æ–≥–¥–∞ —è –≤–∞–º –Ω–µ –Ω—É–∂–µ–Ω'",
"–°—Ç—É–¥–µ–Ω—Ç —Å–ø—Ä–∞—à–∏–≤–∞–µ—Ç —É –ø—Ä–æ—Ñ–µ—Å—Å–æ—Ä–∞: '–ê –º–æ–∂–Ω–æ —è —Å–¥–∞–º —Ä–∞–±–æ—Ç—É –∑–∞–≤—Ç—Ä–∞?' –ü—Ä–æ—Ñ–µ—Å—Å–æ—Ä: '–ö–æ–Ω–µ—á–Ω–æ, –Ω–æ —è –Ω–µ –æ–±–µ—â–∞—é, —á—Ç–æ –±—É–¥—É –∑–∞–≤—Ç—Ä–∞ –∂–∏–≤'",

# –ü—Ä–æ –∂–∏–≤–æ—Ç–Ω—ã—Ö
"–ü–æ—á–µ–º—É –∫—É—Ä–∏—Ü–∞ –ø–µ—Ä–µ—à–ª–∞ –¥–æ—Ä–æ–≥—É? –ß—Ç–æ–±—ã –¥–æ–∫–∞–∑–∞—Ç—å –æ–ø–æ—Å—Å—É–º—É, —á—Ç–æ —ç—Ç–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å!",
"–î–≤–∞ —Ö–æ–º—è–∫–∞ –≤ –∫–æ–ª–µ—Å–µ. –û–¥–∏–Ω –≥–æ–≤–æ—Ä–∏—Ç: '–ù—É —á—Ç–æ, –±–µ–∂–∏–º?' –í—Ç–æ—Ä–æ–π: '–ù–µ—Ç, —è –≤ –ø—Ä–æ—à–ª—ã–π —Ä–∞–∑ —Ç–∞–∫ –Ω–∞–±–µ–≥–∞–ª—Å—è, —á—Ç–æ –¥–æ —Å–∏—Ö –ø–æ—Ä –∫—Ä—É—á—É—Å—å'",
"–ö–æ—Ç –Ω–∞–ø–∏—Å–∞–ª –Ω–∞ –∫–æ–≤—ë—Ä. –•–æ–∑—è–∏–Ω —Ç—ã—á–µ—Ç –µ–≥–æ –Ω–æ—Å–æ–º: '–ë—É–¥–µ—à—å –µ—â—ë –ø–∏—Å–∞—Ç—å?' –ö–æ—Ç –¥—É–º–∞–µ—Ç: '–ù—É —Ç–µ–ø–µ—Ä—å-—Ç–æ —Ç–æ—á–Ω–æ –±—É–¥—É...'",

# –ü—Ä–æ —Ä–∞–±–æ—Ç—É
"–ù–∞—á–∞–ª—å–Ω–∏–∫ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫—É: '–í—ã —É–≤–æ–ª–µ–Ω—ã!' '–ù–æ —è –∂–µ —Ç–æ–ª—å–∫–æ –≤—á–µ—Ä–∞ —É—Å—Ç—Ä–æ–∏–ª—Å—è!' '–î–∞, –∏ —É–∂–µ –æ–ø–æ–∑–¥–∞–ª–∏ —Å–µ–≥–æ–¥–Ω—è!'",
"–†–∞–±–æ—Ç–Ω–∏–∫ —Å–ø—Ä–∞—à–∏–≤–∞–µ—Ç –Ω–∞—á–∞–ª—å–Ω–∏–∫–∞: '–ú–æ–∂–Ω–æ –º–Ω–µ –∑–∞—Ä–ø–ª–∞—Ç—É?' '–ú–æ–∂–Ω–æ, –Ω–æ —Ç–æ–ª—å–∫–æ –Ω–µ –≤—Å—é —Å—Ä–∞–∑—É'",
"–û–±—ä—è–≤–ª–µ–Ω–∏–µ: '–¢—Ä–µ–±—É–µ—Ç—Å—è —á–µ–ª–æ–≤–µ–∫, –∫–æ—Ç–æ—Ä—ã–π –Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞–µ—Ç. –ó–∞—Ä–ø–ª–∞—Ç–∞ ‚Äî –∫–∞–∫ –∑–∞ –ø–æ–ª–Ω—ã–π —Ä–∞–±–æ—á–∏–π –¥–µ–Ω—å'",

# –ü—Ä–æ —Å–µ–º—å—é
"–ú—É–∂ –∂–µ–Ω–µ: '–î–æ—Ä–æ–≥–∞—è, —è –ø–æ—á–∏–Ω–∏–ª —Ä–æ–∑–µ—Ç–∫—É!' '–ö–∞–∫ —Ç—ã —ç—Ç–æ —Å–¥–µ–ª–∞–ª –±–µ–∑ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤?' '–Ø –ø—Ä–æ—Å—Ç–æ –≤—ã–Ω—É–ª –≤–∏–ª–∫—É –∏–∑ –¥—Ä—É–≥–æ–π —Ä–æ–∑–µ—Ç–∫–∏'",
"–†–µ–±—ë–Ω–æ–∫ —Å–ø—Ä–∞—à–∏–≤–∞–µ—Ç –æ—Ç—Ü–∞: '–ü–∞–ø, –∞ –ø–æ—á–µ–º—É —É —Ç–µ–±—è —Ç–∞–∫ –º–∞–ª–æ –≤–æ–ª–æ—Å?' '–ü–æ—Ç–æ–º—É —á—Ç–æ —è –º–Ω–æ–≥–æ –¥—É–º–∞–ª, —Å—ã–Ω–æ–∫' '–ê –ø–æ—á–µ–º—É —Ç–æ–≥–¥–∞ —É –¥–µ–¥—É—à–∫–∏ —Å–æ–≤—Å–µ–º –Ω–µ—Ç –≤–æ–ª–æ—Å?'",
"–ñ–µ–Ω–∞ –º—É–∂—É: '–Ø –ø–æ—Ö–æ–∂–∞ –Ω–∞ —Ü–∞–ø–ª—é?' '–ù–µ—Ç' '–ê —è —Å—Ç–æ—é –Ω–∞ –æ–¥–Ω–æ–π –Ω–æ–≥–µ —É–∂–µ —á–∞—Å, –ø–æ–∫–∞ —Ç—ã —Ä—ã–±–∞—á–∏—à—å!'",

# –î–µ—Ç—Å–∫–∏–µ
"–ü–æ—á–µ–º—É –∫–∞—Ä–∞–Ω–¥–∞—à –ø–ª–æ—Ö–æ –ø–∏—Å–∞–ª? –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω –±—ã–ª —Ç—É–ø–æ–π!",
"–ú–∞–º–∞ –≥–æ–≤–æ—Ä–∏—Ç —Å—ã–Ω—É: '–ï—Å–ª–∏ –±—É–¥–µ—à—å –µ—Å—Ç—å –º–æ—Ä–∫–æ–≤–∫—É, –±—É–¥–µ—à—å –≤–∏–¥–µ—Ç—å –≤ —Ç–µ–º–Ω–æ—Ç–µ!' '–ú–∞–º–∞, —è –∏ —Ç–∞–∫ –≤–∏–∂—É –≤ —Ç–µ–º–Ω–æ—Ç–µ!' '–ö–∞–∫?' '–Ø –∂–µ –Ω–µ –µ–º –º–æ—Ä–∫–æ–≤–∫—É!'",
"–£—á–∏—Ç–µ–ª—å: '–ö—Ç–æ –º–æ–∂–µ—Ç –Ω–∞–∑–≤–∞—Ç—å –ø—è—Ç—å –¥–∏–∫–∏—Ö –∂–∏–≤–æ—Ç–Ω—ã—Ö?' –í–æ–≤–æ—á–∫–∞: '–¢–∏–≥—Ä, —Ç—Ä–∏ —Ç–∏–≥—Ä–∞ –∏ –µ—â—ë –æ–¥–∏–Ω —Ç–∏–≥—Ä!'",

# –ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ
"–í—Ä–∞—á –ø–∞—Ü–∏–µ–Ω—Ç—É: '–£ –≤–∞—Å —Ä–µ–¥–∫–æ–µ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–µ' '–î–æ–∫—Ç–æ—Ä, —ç—Ç–æ —Ö–æ—Ä–æ—à–æ?' '–ù–µ—Ç, —ç—Ç–æ –ø–ª–æ—Ö–æ. –ü—Ä–æ—Å—Ç–æ —è —Ä–µ–¥–∫–æ –æ—à–∏–±–∞—é—Å—å'",
"–ü–∞—Ü–∏–µ–Ω—Ç: '–î–æ–∫—Ç–æ—Ä, —è –Ω–µ –º–æ–≥—É –≤—Å–ø–æ–º–Ω–∏—Ç—å, —á—Ç–æ –º–Ω–µ –Ω—É–∂–Ω–æ –¥–µ–ª–∞—Ç—å' –î–æ–∫—Ç–æ—Ä: '–ó–∞–±—ã–ª–∏?' '–î–∞!' '–¢–æ–≥–¥–∞ –ø—Ä–∏—Ö–æ–¥–∏—Ç–µ –∑–∞–≤—Ç—Ä–∞'",
"–î–æ–∫—Ç–æ—Ä: '–í–∞–º –Ω—É–∂–Ω–æ –±—Ä–æ—Å–∏—Ç—å –∫—É—Ä–∏—Ç—å, –ø–∏—Ç—å –∏ –µ—Å—Ç—å –∂–∏—Ä–Ω–æ–µ' –ü–∞—Ü–∏–µ–Ω—Ç: '–ò —Å–∫–æ–ª—å–∫–æ —è —Ç–æ–≥–¥–∞ –ø—Ä–æ–∂–∏–≤—É?' '–ù–µ –∑–Ω–∞—é, –Ω–æ –≤—Ä–µ–º—è –±—É–¥–µ—Ç —Ç—è–Ω—É—Ç—å—Å—è –æ—á–µ–Ω—å –º–µ–¥–ª–µ–Ω–Ω–æ'",

# –ü—Ä–æ —Ç–µ—Ö–Ω–∏–∫—É
"–ü–æ—á–µ–º—É –∫–æ–º–ø—å—é—Ç–µ—Ä –ø–ª–æ—Ö–æ —Å–ø–∞–ª? –ü–æ—Ç–æ–º—É —á—Ç–æ —É –Ω–µ–≥–æ –±—ã–ª–∞ Windows!",
"–¢–µ–ª–µ—Ñ–æ–Ω –≥–æ–≤–æ—Ä–∏—Ç –¥—Ä—É–≥–æ–º—É —Ç–µ–ª–µ—Ñ–æ–Ω—É: '–ü—Ä–∏–≤–µ—Ç!' '–ò–∑–≤–∏–Ω–∏, —è –Ω–∞ –ø—Ä–æ–≤–æ–¥–µ'",
"–ñ–µ–Ω–∞ –º—É–∂—É: '–ü–æ—á–µ–º—É —Ç—ã –∫—É–ø–∏–ª —Ç–∞–∫–æ–π –¥–æ—Ä–æ–≥–æ–π —Ç–µ–ª–µ—Ñ–æ–Ω?' '–û–Ω —É–º–Ω—ã–π!' '–¢–æ–≥–¥–∞ –ø—É—Å—Ç—å —Å–∞–º –∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç!'",

# –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ
"–ò–≤–∞–Ω –ì—Ä–æ–∑–Ω—ã–π —Å–ø—Ä–∞—à–∏–≤–∞–µ—Ç —É –ø—Ä–∏–¥–≤–æ—Ä–Ω–æ–≥–æ: '–ü–æ—á–µ–º—É —Ç—ã –¥—Ä–æ–∂–∏—à—å?' '–í–∞—à–µ –í–µ–ª–∏—á–µ—Å—Ç–≤–æ, —è –Ω–µ –¥—Ä–æ–∂—É, —è —Ç–∞–Ω—Ü—É—é!'",
"–ù–∞ —Ä–∞—Å–∫–æ–ø–∫–∞—Ö –Ω–∞—à–ª–∏ –¥—Ä–µ–≤–Ω–∏–π –∫–æ–º–ø—å—é—Ç–µ—Ä. –ê—Ä—Ö–µ–æ–ª–æ–≥–∏ –¥—É–º–∞—é—Ç ‚Äî —Ç–æ –ª–∏ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä, —Ç–æ –ª–∏ –∫–∞–º–µ–Ω–Ω—ã–π –Ω–æ—É—Ç–±—É–∫...",
"–ü–µ—Ä–≤–æ–±—ã—Ç–Ω—ã–π —á–µ–ª–æ–≤–µ–∫ –∏–∑–æ–±—Ä—ë–ª –∫–æ–ª–µ—Å–æ. –î—Ä—É–≥–æ–π –ø–µ—Ä–≤–æ–±—ã—Ç–Ω—ã–π —á–µ–ª–æ–≤–µ–∫: '–ê —Ç–µ–ø–µ—Ä—å –ø—Ä–∏–¥–µ–ª–∞–π –∫ –Ω–µ–º—É –µ—â—ë —Ç—Ä–∏ –∏ –ø–æ–ª—É—á–∏—Ç—Å—è –º–∞—à–∏–Ω–∞!'",

# –ü—Ä–æ –¥–µ–Ω—å–≥–∏
"–ë–∞–Ω–∫–∏—Ä —Å–ø—Ä–∞—à–∏–≤–∞–µ—Ç –∫–ª–∏–µ–Ω—Ç–∞: '–í—ã —Ö–æ—Ç–∏—Ç–µ –≤–∑—è—Ç—å –∫—Ä–µ–¥–∏—Ç?' '–ù–µ—Ç, —è —Ö–æ—á—É –¥–µ–Ω—å–≥–∏!'",
"–ú—É–∂ –∂–µ–Ω–µ: '–î–æ—Ä–æ–≥–∞—è, —è –Ω–∞—à—ë–ª —Å–ø–æ—Å–æ–± —ç–∫–æ–Ω–æ–º–∏—Ç—å!' '–ö–∞–∫–æ–π?' '–ú—ã –±—É–¥–µ–º –º–µ–Ω—å—à–µ —Ç—Ä–∞—Ç–∏—Ç—å!'",
"–û–±—ä—è–≤–ª–µ–Ω–∏–µ: '–î–∞—é –¥–µ–Ω—å–≥–∏ –≤ –¥–æ–ª–≥ –ø–æ–¥ 0%. –ü–µ—Ä–≤–æ–º—É, –∫—Ç–æ –ø–æ–≤–µ—Ä–∏—Ç'",

# –®—É—Ç–æ—á–Ω—ã–µ –¥–∏–∞–ª–æ–≥–∏
"- –¢—ã –≥–¥–µ –±—ã–ª? - –î–∞ —Ç–∞–∫, –Ω–∏–≥–¥–µ... - –ê –≥–¥–µ —ç—Ç–æ?",
"- –ü–æ—á–µ–º—É —Ç—ã –Ω–µ –æ—Ç–≤–µ—á–∞–µ—à—å –Ω–∞ –º–æ–∏ —Å–æ–æ–±—â–µ–Ω–∏—è? - –Ø –∏—Ö –Ω–µ –ø–æ–ª—É—á–∞–ª! - –ö–∞–∫ –Ω–µ –ø–æ–ª—É—á–∞–ª? –Ø –∂–µ –≤–∏–∂—É, —á—Ç–æ —Ç—ã –ø—Ä–æ—á–∏—Ç–∞–ª! - –ù—É –≤–æ—Ç, —Ç–µ–ø–µ—Ä—å –ø–æ–ª—É—á–∏–ª...",
"- –¢—ã –ø–æ–º–Ω–∏—à—å, –∫–∞–∫ –º—ã –ø–æ–∑–Ω–∞–∫–æ–º–∏–ª–∏—Å—å? - –ù–µ—Ç - –ò —è –Ω–µ –ø–æ–º–Ω—é. –ö–∞–∂–µ—Ç—Å—è, –Ω–∞—Å –ø–æ–∑–Ω–∞–∫–æ–º–∏–ª–∏...",

# –ü—Ä–æ —Å–ø–æ—Ä—Ç
"–§—É—Ç–±–æ–ª–∏—Å—Ç –ø–æ—Å–ª–µ –º–∞—Ç—á–∞: '–Ø –±–µ–∂–∞–ª —Ç–∞–∫ –±—ã—Å—Ç—Ä–æ, —á—Ç–æ –¥–∞–∂–µ –∑–∞–±—ã–ª –º—è—á!'",
"–¢—Ä–µ–Ω–µ—Ä –∫–æ–º–∞–Ω–¥–µ: '–í—ã –∏–≥—Ä–∞–µ—Ç–µ –∫–∞–∫ —Å—Ç–∞–¥–æ –±–∞—Ä–∞–Ω–æ–≤!' –ö–∞–ø–∏—Ç–∞–Ω: '–¢—Ä–µ–Ω–µ—Ä, —ç—Ç–æ –æ—Å–∫–æ—Ä–±–ª–µ–Ω–∏–µ!' '–î–ª—è –±–∞—Ä–∞–Ω–æ–≤ ‚Äî –¥–∞!'",
"–ë–æ–∫—Å—ë—Ä –ø–µ—Ä–µ–¥ –±–æ–µ–º: '–Ø –Ω–µ –±–æ—é—Å—å —Å–æ–ø–µ—Ä–Ω–∏–∫–∞!' –¢—Ä–µ–Ω–µ—Ä: '–¢–æ–≥–¥–∞ –∑–∞—á–µ–º —Ç—ã –Ω–∞–¥–µ–ª –º–æ–∏ —à–æ—Ä—Ç—ã?'",

# –ü—Ä–æ –Ω–∞—É–∫—É
"–£—á—ë–Ω—ã–µ –∏–∑–æ–±—Ä–µ–ª–∏ –Ω–æ–≤—É—é —ç–ª–µ–º–µ–Ω—Ç–∞—Ä–Ω—É—é —á–∞—Å—Ç–∏—Ü—É ‚Äî –ª–µ–Ω—å. –ù–æ –∏–∑—É—á–∞—Ç—å –µ—ë –ø–æ–∫–∞ –Ω–µ —Ö–æ—Ç—è—Ç...",
"–§–∏–∑–∏–∫ –≥–æ–≤–æ—Ä–∏—Ç –¥—Ä—É–≥—É: '–Ø –∏–∑–æ–±—Ä—ë–ª –º–∞—à–∏–Ω—É –≤—Ä–µ–º–µ–Ω–∏!' '–ò —á—Ç–æ?' '–î–∞ –Ω–∏—á–µ–≥–æ, –ø—Ä–æ—Å—Ç–æ –ø–æ—Ö–≤–∞—Å—Ç–∞—Ç—å—Å—è'",
"–ú–∞—Ç–µ–º–∞—Ç–∏–∫ —Ç–æ–Ω–µ—Ç –≤ —Ä–µ–∫–µ –∏ –∫—Ä–∏—á–∏—Ç: '–ü–æ–º–æ–≥–∏—Ç–µ! –Ø –Ω–µ —É–º–µ—é –ø–ª–∞–≤–∞—Ç—å!' –ü—Ä–æ—Ö–æ–∂–∏–π: '–¢–∞–∫ –≤—Å—Ç–∞–Ω—å—Ç–µ –Ω–∞ –¥–Ω–æ!' '–ê –æ–Ω–æ –µ—Å—Ç—å?'",

# –ü—Ä–æ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏—è
"–¢—É—Ä–∏—Å—Ç —Å–ø—Ä–∞—à–∏–≤–∞–µ—Ç —É –º–µ—Å—Ç–Ω–æ–≥–æ: '–ö–∞–∫ –ø—Ä–æ–π—Ç–∏ –∫ –º–æ—Ä—é?' '–ú–∏–ª–ª–∏–æ–Ω –ª–µ—Ç –ø—Ä—è–º–æ, –ø–æ—Ç–æ–º –Ω–∞–ø—Ä–∞–≤–æ'",
"–ü–æ—á–µ–º—É –ø—É—Ç–µ—à–µ—Å—Ç–≤–µ–Ω–Ω–∏–∫ –≤–∑—è–ª —Å —Å–æ–±–æ–π –ª–µ—Å—Ç–Ω–∏—Ü—É? –ß—Ç–æ–±—ã –ø–æ–¥–Ω—è—Ç—å—Å—è –Ω–∞ –≠–≤–µ—Ä–µ—Å—Ç —Å—Ç—É–ø–µ–Ω—å–∫–∞ –∑–∞ —Å—Ç—É–ø–µ–Ω—å–∫–æ–π!",
"–¢–∞–º–æ–∂–µ–Ω–Ω–∏–∫ —Å–ø—Ä–∞—à–∏–≤–∞–µ—Ç —Ç—É—Ä–∏—Å—Ç–∞: '–£ –≤–∞—Å –µ—Å—Ç—å —á—Ç–æ-—Ç–æ —Ü–µ–Ω–Ω–æ–µ?' '–î–∞, –º–æ—è –∂–µ–Ω–∞!' '–•–º... –ú–æ–∂–µ—Ç–µ –ø—Ä–æ—Ö–æ–¥–∏—Ç—å'",

# –ü—Ä–æ –µ–¥—É
"–ü–æ—á–µ–º—É —Ö–ª–µ–± –≥—Ä—É—Å—Ç–Ω—ã–π? –ü–æ—Ç–æ–º—É —á—Ç–æ –µ–≥–æ –≤—Å–µ —Ä–µ–∂—É—Ç!",
"–®–µ—Ñ-–ø–æ–≤–∞—Ä —É—á–µ–Ω–∏–∫—É: '–¢—ã –ø–µ—Ä–µ—Å–æ–ª–∏–ª —Å—É–ø!' '–ù–æ —è –µ—â—ë –Ω–µ —Å–æ–ª–∏–ª!' '–í–æ—Ç –∏–º–µ–Ω–Ω–æ!'",
"–ú—É–∂ –∂–µ–Ω–µ: '–ß—Ç–æ –Ω–∞ —É–∂–∏–Ω?' '–°—é—Ä–ø—Ä–∏–∑!' '–û–ø—è—Ç—å —è–∏—á–Ω–∏—Ü–∞...'",

# –ü—Ä–æ –∞—Ä–º–∏—é
"–°–æ–ª–¥–∞—Ç –¥–æ–∫–ª–∞–¥—ã–≤–∞–µ—Ç –∫–æ–º–∞–Ω–¥–∏—Ä—É: '–¢–æ–≤–∞—Ä–∏—â –≥–µ–Ω–µ—Ä–∞–ª, –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫ —Å–¥–∞—ë—Ç—Å—è!' '–û—Ç–ª–∏—á–Ω–æ! –ê –∫—Ç–æ —ç—Ç–æ —Ç–∞–∫–æ–π –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫?'",
"–†–µ–∫—Ä—É—Ç–∞ —Å–ø—Ä–∞—à–∏–≤–∞—é—Ç: '–ü–æ—á–µ–º—É –≤—ã —Ö–æ—Ç–∏—Ç–µ —Å–ª—É–∂–∏—Ç—å –≤ –∞—Ä–º–∏–∏?' '–ß—Ç–æ–±—ã –Ω–∞—É—á–∏—Ç—å—Å—è –æ—Ç–¥–∞–≤–∞—Ç—å —á–µ—Å—Ç—å!' '–ö–æ–º—É?' '–í—Å–µ–º –ø–æ–¥—Ä—è–¥!'",
"–°–µ—Ä–∂–∞–Ω—Ç –Ω–æ–≤–æ–±—Ä–∞–Ω—Ü—É: '–í—ã —á—Ç–æ, —Å–æ–≤—Å–µ–º –¥—É—Ä–∞–∫?' '–ù–µ—Ç, —è —Ç–æ–ª—å–∫–æ –ø–æ —Å—Ä–µ–¥–∞–º!'",

# –ü—Ä–æ —à–∫–æ–ª—É
"–£—á–∏—Ç–µ–ª—å: '–ö—Ç–æ –º–æ–∂–µ—Ç –Ω–∞–∑–≤–∞—Ç—å —Å–∞–º–æ–µ –±—ã—Å—Ç—Ä–æ–µ —Å—É—â–µ—Å—Ç–≤–æ?' –í–æ–≤–æ—á–∫–∞: '–ú—ã—Å–ª—å! –û–Ω–∞ –∑–∞ —Å–µ–∫—É–Ω–¥—É –≤–æ–∫—Ä—É–≥ —Å–≤–µ—Ç–∞!' '–ê –ø—Ä–∏–º–µ—Ä?' '–Ø —Ç–æ–ª—å–∫–æ —á—Ç–æ –ø–æ–¥—É–º–∞–ª –æ–± –∫–∞–Ω–∏–∫—É–ª–∞—Ö!'",
"–î–∏—Ä–µ–∫—Ç–æ—Ä —à–∫–æ–ª—ã —É—á–∏—Ç–µ–ª—é: '–ü–æ—á–µ–º—É —É –≤–∞—Å –≤ –∫–ª–∞—Å—Å–µ —Ç–∞–∫ —à—É–º–Ω–æ?' '–≠—Ç–æ –Ω–µ —à—É–º, —ç—Ç–æ –∫–æ–ª–ª–µ–∫—Ç–∏–≤–Ω–æ–µ –æ–±—Å—É–∂–¥–µ–Ω–∏–µ!'",
"–£—á–µ–Ω–∏–∫ —Å–ø—Ä–∞—à–∏–≤–∞–µ—Ç —É—á–∏—Ç–µ–ª—è: '–ê –ø—Ä–∞–≤–¥–∞, —á—Ç–æ —Ä–∞–Ω—å—à–µ –ª—é–¥–∏ –∂–∏–ª–∏ –¥–æ 300 –ª–µ—Ç?' '–ù–µ—Ç, —ç—Ç–æ –º–∏—Ñ' '–¢–æ–≥–¥–∞ –∑–∞—á–µ–º –≤—ã –º–Ω–µ –ø–æ—Å—Ç–∞–≤–∏–ª–∏ 300 –ª–µ—Ç –¥–æ–º–∞—à–Ω–µ–π —Ä–∞–±–æ—Ç—ã?'",

# –ü—Ä–æ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç
"–ü–æ—á–µ–º—É –ø–æ–µ–∑–¥ –æ–ø–æ–∑–¥–∞–ª? –ü–æ—Ç–æ–º—É —á—Ç–æ –µ–≥–æ —Ä–µ–ª—å—Å—ã –±—ã–ª–∏ –≤ –¥—Ä—É–≥–æ–º —á–∞—Å–æ–≤–æ–º –ø–æ—è—Å–µ!",
"–ü–∞—Å—Å–∞–∂–∏—Ä –≤–æ–¥–∏—Ç–µ–ª—é –∞–≤—Ç–æ–±—É—Å–∞: '–í—ã –ø—Ä–æ–µ—Ö–∞–ª–∏ –º–æ—é –æ—Å—Ç–∞–Ω–æ–≤–∫—É!' '–ù–µ –≤–æ–ª–Ω—É–π—Ç–µ—Å—å, —Å–ª–µ–¥—É—é—â–∞—è —á–µ—Ä–µ–∑ 500 –º–µ—Ç—Ä–æ–≤!' '–ù–æ —è –∂–µ –ø–µ—à–∫–æ–º –∏–¥—É!'",
"–ì–ê–ò—à–Ω–∏–∫ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –º–∞—à–∏–Ω—É: '–í—ã –ø—Ä–µ–≤—ã—Å–∏–ª–∏ —Å–∫–æ—Ä–æ—Å—Ç—å!' '–ù–æ —è —Ç–æ–ª—å–∫–æ –Ω–∞—á–∞–ª –¥–≤–∏–∂–µ–Ω–∏–µ!' '–í–æ—Ç –∏–º–µ–Ω–Ω–æ!'",

# –ü—Ä–æ –∏—Å–∫—É—Å—Å—Ç–≤–æ
"–•—É–¥–æ–∂–Ω–∏–∫ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–∞—Ä—Ç–∏–Ω—É: '–≠—Ç–æ –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–æ–Ω–∏–∑–º!' '–ê –≥–¥–µ —Ä–∞–º–∫–∞?' '–≠—Ç–æ –∏ –µ—Å—Ç—å –∞–±—Å—Ç—Ä–∞–∫—Ü–∏—è!'",
"–ú—É–∑—ã–∫–∞–Ω—Ç –∂–∞–ª—É–µ—Ç—Å—è: '–ú–æ—è —Å–∫—Ä–∏–ø–∫–∞ –Ω–µ –∏–≥—Ä–∞–µ—Ç!' '–ú–æ–∂–µ—Ç, –µ—ë –Ω–∞–¥–æ –≤–∫–ª—é—á–∏—Ç—å?'",
"–ê–∫—Ç—ë—Ä –Ω–∞ –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏–∏: '–Ø –º–æ–≥—É —Å—ã–≥—Ä–∞—Ç—å –ª—é–±—É—é —Ä–æ–ª—å!' '–¢–æ–≥–¥–∞ —Å—ã–≥—Ä–∞–π—Ç–µ –∑—Ä–∏—Ç–µ–ª—è!'"
]  

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∞—É–¥–∏–æ —Å–∏—Å—Ç–µ–º—ã
pygame.mixer.init()
TEMP_DIR = tempfile.gettempdir()
command_queue = queue.Queue()

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –≥–æ–ª–æ—Å–æ–≤–æ–≥–æ –ø–æ–º–æ—â–Ω–∏–∫–∞
class Config:
    WAKE_WORDS = ['–∫–µ—à–∞', '–∫–µ—à', '–≥–æ—à–∞', '–∫—ç—à','–≤–∞–ª–µ—Ä–∞','—á–µ–±—É—Ä–µ–∫']
    SENSITIVITY = 0.5
    ENERGY_THRESHOLD = 1000
    PAUSE_THRESHOLD = 2
    DYNAMIC_ENERGY = True
    TIMEOUT = 1.5
    PHRASE_LIMIT = 3

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≥—Ä–æ–º–∫–æ—Å—Ç—å—é
try:
    devices = AudioUtilities.GetSpeakers()
    interface = devices.Activate(IAudioEndpointVolume._iid_, CLSCTX_ALL, None)
    volume_control = cast(interface, POINTER(IAudioEndpointVolume))
    VOLUME_CONTROL_ENABLED = True
except:
    VOLUME_CONTROL_ENABLED = False
    print("–ù–µ —É–¥–∞–ª–æ—Å—å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≥—Ä–æ–º–∫–æ—Å—Ç—å—é")

class AudioManager:
    """–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ–º –∞—É–¥–∏–æ"""
    def __init__(self):
        self._init_mixer()
        self.playback_thread = None

    def _init_mixer(self):
        try:
            pygame.mixer.init(frequency=22050, size=-16, channels=2, buffer=512)
        except:
            print("–û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∞—É–¥–∏–æ –º–∏–∫—à–µ—Ä–∞")

    def say(self, text):
        """–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞"""
        if not text.strip():
            return

        try:
            filename = os.path.join(TEMP_DIR, f"voice_{int(time.time()*1000)}.mp3")
            tts = gTTS(text=text, lang='ru', slow=False)
            tts.save(filename)

            if self.playback_thread and self.playback_thread.is_alive():
                pygame.mixer.music.stop()
                self.playback_thread.join(timeout=0.1)

            try:
                pygame.mixer.music.load(filename)
                pygame.mixer.music.play()
            except:
                self._init_mixer()
                pygame.mixer.music.load(filename)
                pygame.mixer.music.play()

            self.playback_thread = threading.Thread(
                target=self._cleanup_audio,
                args=(filename,),
                daemon=True
            )
            self.playback_thread.start()

        except Exception as e:
            print(f"–û—à–∏–±–∫–∞ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è: {e}")

    def _cleanup_audio(self, filename):
        """–û—á–∏—Å—Ç–∫–∞ –∞—É–¥–∏–æ—Ñ–∞–π–ª–æ–≤ –ø–æ—Å–ª–µ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è"""
        while pygame.mixer.music.get_busy():
            time.sleep(0.05)
        try:
            if os.path.exists(filename):
                os.remove(filename)
        except:
            pass

audio_manager = AudioManager()

class VoiceRecognizer:
    """–†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –≥–æ–ª–æ—Å–æ–≤—ã—Ö –∫–æ–º–∞–Ω–¥"""
    def __init__(self):
        self.recognizer = sr.Recognizer()
        self.recognizer.energy_threshold = Config.ENERGY_THRESHOLD
        self.recognizer.pause_threshold = Config.PAUSE_THRESHOLD
        self.recognizer.dynamic_energy_threshold = Config.DYNAMIC_ENERGY

    def listen(self, timeout=1.5):
        """–°–ª—É—à–∞–µ–º –º–∏–∫—Ä–æ—Ñ–æ–Ω —Å —Ç–∞–π–º–∞—É—Ç–æ–º"""
        with sr.Microphone() as source:
            try:
                audio = self.recognizer.listen(
                    source, 
                    timeout=timeout,
                    phrase_time_limit=Config.PHRASE_LIMIT
                )
                return self.recognizer.recognize_google(audio, language='ru-RU').lower()
            except (sr.WaitTimeoutError, sr.UnknownValueError):
                return ""
            except Exception as e:
                print(f"–û—à–∏–±–∫–∞ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è: {e}")
                return ""

def re(text):
    """–ë—ã—Å—Ç—Ä—ã–π –≤—ã–≤–æ–¥ –∏ –æ–∑–≤—É—á–∏–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞"""
    print(text)
    audio_manager.say(text)

def listen_for_wake_word():
    """–ü—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏–µ –∫–ª—é—á–µ–≤–æ–≥–æ —Å–ª–æ–≤–∞ –¥–ª—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏"""
    recognizer = VoiceRecognizer()
    re("–ì–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ, –∂–¥—É –∫–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ...")
    print("–∫–µ—à–∞, –∫–µ—à, –≥–æ—à–∞, –∫—ç—à, –≤–∞–ª–µ—Ä–∞, —á–µ–±—É—Ä–µ–∫")
    while True:
        try:
            text = recognizer.listen(timeout=Config.TIMEOUT)
            if any(word in text for word in Config.WAKE_WORDS):
                command_queue.put("wake_word_detected")
        except Exception as e:
            print(f"–û—à–∏–±–∫–∞ –≤ listen_for_wake_word: {e}")
            time.sleep(0.1)

def recognize_command():
    """–†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã –ø–æ—Å–ª–µ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏"""
    recognizer = VoiceRecognizer()
    re("–°–ª—É—à–∞—é...")
    return recognizer.listen()

def process_commands():
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–∞–Ω–¥ –∏–∑ –æ—á–µ—Ä–µ–¥–∏"""
    while True:
        command = command_queue.get()
        if command == "wake_word_detected":
            command_text = recognize_command()
            if command_text:
                threading.Thread(
                    target=handle_command,
                    args=(command_text,),
                    daemon=True
                ).start()
            else:
                re("–Ø –≤–∞—Å –Ω–µ —Ä–∞—Å—Å–ª—ã—à–∞–ª, –ø–æ–≤—Ç–æ—Ä–∏—Ç–µ –ø–æ–∂–∞–ª—É–π—Å—Ç–∞")

def set_system_volume(level):
    """–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –≥—Ä–æ–º–∫–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã"""
    if not VOLUME_CONTROL_ENABLED:
        return False
    try:
        volume_control.SetMasterVolumeLevelScalar(level, None)
        return True
    except:
        return False

def get_system_volume():
    """–ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–π –≥—Ä–æ–º–∫–æ—Å—Ç–∏"""
    if not VOLUME_CONTROL_ENABLED:
        return 0.5
    try:
        return volume_control.GetMasterVolumeLevelScalar()
    except:
        return 0.5

def change_volume(direction):
    """–ò–∑–º–µ–Ω–µ–Ω–∏–µ –≥—Ä–æ–º–∫–æ—Å—Ç–∏"""
    current = get_system_volume()
    if direction == 'up':
        new_vol = min(1.0, current + 0.1)
    elif direction == 'down':
        new_vol = max(0.0, current - 0.1)
    else:
        return current

    if set_system_volume(new_vol):
        return new_vol
    return current

def handle_command(text):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∫–æ–º–∞–Ω–¥—ã"""
    if not text:
        return

    print(f"–†–∞—Å–ø–æ–∑–Ω–∞–Ω–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞: {text}")
    text = text.lower().strip()
    try:
        if any(word in text for word in ['–ø–æ–∫–∞', '–≤—ã—Ö–æ–¥', '—Å—Ç–æ–ø']):
            re('–î–æ —Å–≤–∏–¥–∞–Ω–∏—è!')
            os._exit(0)

        elif '–Ω–∞–π–¥–∏ –≤ —é—Ç—É–±–∏' in text:
            quertty = text.replace("–Ω–∞–π–¥–∏ –≤ —é—Ç—É–±–∏", "").strip()
            if quertty:
                search_and_open_youtube(quertty)
                re('–í–æ—Ç —á—Ç–æ —è –Ω–∞—à—ë–ª')
            else:
                re('–ß—Ç–æ –∏–º–µ–Ω–Ω–æ –≤–∞–º –Ω–∞–π—Ç–∏?')

        elif '–æ—Ç–∫—Ä–æ–π roblox' in text:
            os.startfile(r'C:\Users\Yusuf\AppData\Local\Roblox\Versions\version-fe20d41d8fec4770\RobloxPlayerBeta')
            re('–û—Ç–∫—Ä—ã–≤–∞—é')

        elif '–æ—Ç–∫—Ä–æ–π minecraft' in text:
            os.startfile(r'C:\Users\Yusuf\OneDrive\–†–∞–±–æ—á–∏–π —Å—Ç–æ–ª\MINECRAFT')
            re('–û—Ç–∫—Ä—ã–≤–∞—é')
            
        elif '–ø–µ—Ä–µ–≤–µ–¥–∏ –Ω–∞' in text:
                if '–∞–Ω–≥–ª–∏–π—Å–∫–∏–π' in text:
                    m = text.replace("–ø–µ—Ä–µ–≤–µ–¥–∏ –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–∏–π", "").strip()
                    while True:
                        try:
                            webbrowser.open(f'https://translate.yandex.ru/?from=tableau_yabro&source_lang=ru&target_lang=en&text={m}')
                            time.sleep(2)
                            for i in range(13):
                                time.sleep(0.0000001)
                                keyboard.send('Tab')
                            re(f'{m} –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º')
                            time.sleep(2)
                            keyboard.send('alt+ctrl+V')
                            break
                        except:
                            keyboard.send('alt+Shift')
                            keyboard.send('alt+ctrl+V')
                            break

                elif '—Ä—É—Å—Å–∫–∏–π' in text:
                    m = text.replace("–ø–µ—Ä–µ–≤–µ–¥–∏ –Ω–∞ —Ä—É—Å—Å–∫–∏–π", "").strip()
                    while True:
                        try:
                            webbrowser.open(f'https://translate.yandex.ru/?from=tableau_yabro&source_lang=en&target_lang=ru&text={m}')
                            time.sleep(2)
                            for i in range(13):
                                time.sleep(0.0000001)
                                keyboard.send('Tab')
                            re(f'{m} –Ω–∞ —Ä—É—Å—Å–∫–æ–º')
                            time.sleep(2)
                            keyboard.send('alt+ctrl+V')
                            break
                        except:
                            keyboard.send('alt+Shift')
                            keyboard.send('alt+ctrl+V')
                            break

        elif 'youtube' in text:
            webbrowser.open('https://www.youtube.com/')
            re('–û—Ç–∫—Ä—ã–≤–∞—é YouTube')
        
        elif '–∫–∞–º–µ–Ω—å –Ω–æ–∂–Ω–∏—Ü—ã –±—É–º–∞–≥–∞' in text:
            re('–ó–∞–ø—É—Å–∫–∞—é –∏–≥—Ä—É –∫–∞–º–µ–Ω—å –Ω–æ–∂–Ω–∏—Ü—ã –±—É–º–∞–≥–∞\n')
            start('stone_knots_paper.py')

        elif '–≤–∏—Å–µ–ª–∏—Ü' in text:
            re('–ó–∞–ø—É—Å–∫–∞—é –∏–≥—Ä—É –≤–∏—Å–µ–ª–∏—Ü–∞\n')
            start('hangman.py')

        elif '–≤–∏–∫—Ç–æ—Ä–∏–Ω' in text:
            re('–ó–∞–ø—É—Å–∫–∞—é –∏–≥—Ä—É –≤–∏–∫—Ç–æ—Ä–∏–Ω–∞\n')
            start('quiz.py')

        elif '–≤–Ω–∏–∑' in text:
            mouse.wheel(-1)

        elif '–≤–µ—Ä—Ö' in text:
            mouse.wheel(1)

        elif '–∫–≤–µ—Å—Ç' in text:
            re('–ó–∞–ø—É—Å–∫–∞—é –∏–≥—Ä—É –∫–≤–µ—Å—Ç\n')
            start('quest.py')

        elif '–∫—Ä–µ—Å—Ç–∏–∫–∏-–Ω–æ–ª–∏–∫–∏' in text:
            re('–ó–∞–ø—É—Å–∫–∞—é –∏–≥—Ä—É –∫—Ä–µ—Å—Ç–∏–∫–∏ –Ω–æ–ª–∏–∫–∏\n')
            start('tictactoe.py')

        elif '—É–≥–∞–¥–∞–π —á–∏—Å–ª–æ' in text:
            re('–ó–∞–ø—É—Å–∫–∞—é –∏–≥—Ä—É —É–≥–∞–¥–∞–π —á–∏—Å–ª–æ\n')
            start('rand_game.py')

        elif any(word in text for word in ['–¥–∏–ø—Å–∏', 'deep', 'deepseek']):
            re('–û—Ç–∫—Ä—ã–≤–∞—é –Ω–µ–π—Ä–æ—Å–µ—Ç—å –¥–∏–ø—Å–∏–∫')
            webbrowser.open('https://chat.deepseek.com/a/chat/s/5e62a9fe-9717-452d-9a82-89c2ca2dd30b')

        elif '–ø–µ—Ä–µ–≤–æ–¥—á–∏–∫' in text:
            re('–û—Ç–∫—Ä—ã–≤–∞—é –ø–µ—Ä–µ–≤–æ–¥—á–∏–∫')
            webbrowser.open('https://translate.yandex.ru/?111=')

        elif '–∏–≥—Ä—ã' in text:
            re('–û—Ç–∫—Ä—ã–≤–∞—é —è–Ω–¥–µ–∫—Å –∏–≥—Ä—ã')
            webbrowser.open('https://yandex.ru/games/')

        elif '–∫–∞–∫ –¥–µ–ª–∞' in text:
           re('–í—Å—ë –æ—Ç–ª–∏—á–Ω–æ!–ë—É–¥–µ—Ç –µ—â—ë –ª—É—á—à–µ –µ—Å–ª–∏ —è —Å–º–æ–≥—É –≤–∞–º –ø–æ–º–æ—á—å')

        elif '–º–æ–ª–æ–¥–µ—Ü' in text:
            re('–°–ø–∞—Å–∏–±–æ!–í—Å–µ–≥–¥–∞ –∫ –≤–∞—à–∏–º —É—Å–ª—É–≥–∞–º')

        elif '–ø—Ä–∏–≤–µ—Ç' in text:
            re('–ü—Ä–∏–≤–µ—Ç! –ß–µ–º –º–æ–≥—É –ø–æ–º–æ—á—å?')

        elif '–Ω–∞–π–¥–∏' in text:
            querty = text.replace("–Ω–∞–π–¥–∏", "").strip()
            if querty:
                webbrowser.open_new_tab(f'https://yandex.ru/search/?text={querty}')
                re(f'–ò—â—É {querty}')
            else:
                re('–ß—Ç–æ –∏–º–µ–Ω–Ω–æ –≤–∞–º –Ω–∞–π—Ç–∏?')

        elif '–ø–æ–≥–æ–¥' in text:
            a = get_text_with_url('https://rp5.ru/–ü–æ–≥–æ–¥–∞_–≤_–°–æ—Å–µ–Ω–∫–∞—Ö,_–ú–æ—Å–∫–≤–∞','t_0')
            re(a)
            
        elif 'fire kill' in text:
            start(r'game\FireKill.py')
            re('–ó–∞–ø—É—Å–∫–∞—é')
            
        elif '–æ—Ç–∫—Ä–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏' in text:
            keyboard.send('Win + I')
            re('–ï—Å—Ç—å')

        # –î–ª—è —Ç–µ—Ö —É –∫–æ–≥–æ —É–º–Ω—ã–π –¥–æ–º

        elif '–≤–∫–ª—é—á–∏ —Å–≤–µ—Ç' in text:
            webbrowser.open('https://alice.yandex.ru?')
            time.sleep(2)
            keyboard.write('–í–∫–ª—é—á–∏ —Å–≤–µ—Ç–∏–ª—å–Ω–∏–∫')
            keyboard.send('Enter')
            re('–û–∫')
        
        elif '–≤—ã–∫–ª—é—á–∏ —Å–≤–µ—Ç' in text:
            webbrowser.open('https://alice.yandex.ru?')
            time.sleep(2)
            keyboard.write('–í—ã–∫–ª—é—á–∏ —Å–≤–µ—Ç')
            keyboard.send('Enter')
            re('–û–∫')

        elif '–ø–æ—Å—Ç–∞–≤—å —Ç–∞–π–º–µ—Ä –Ω–∞' in text:
            w = text.replace("–ø–æ—Å—Ç–∞–≤—å —Ç–∞–π–º–µ—Ä –Ω–∞", "").strip()
            w = w.replace("–º–∏–Ω—É—Ç—É", "").strip()
            w = w.replace("–º–∏–Ω—É—Ç", "").strip()
            w = w.replace("—ã", "").strip()
            if w:
                start('timer.py')
                time.sleep(3)
                keyboard.write(w)
                keyboard.send('Enter') 
                re('–¢–∞–π–º–µ—Ä —É—Å–ø–µ—à–Ω–æ –∑–∞–ø—É—â–µ–Ω') 
            else:
                re('–£—Ç–æ—á–Ω–∏—Ç–µ –Ω–∞ —Å–∫–æ–ª—å–∫–æ –ø–æ—Å—Ç–∞–≤–∏—Ç—å —Ç–∞–π–º–µ—Ä')

        elif '–º—É–∑—ã–∫–∞' in text:
            q = text.replace("–º—É–∑—ã–∫–∞", "").strip()
            if q:
                AppOpener.open('Yandex',True)
                webbrowser.open(f'https://rus.hitmotop.com/search?q={q}')
                time.sleep(1)
                keyboard.send('Tab')
                keyboard.send('space')
                re('–ü–æ—Å–ª—É—à–∞–π—Ç–µ, —á—Ç–æ —è –Ω–∞—à—ë–ª')
                time.sleep(2)
                mouse.move(252, 794)
                mouse.click('left')
            else:
                AppOpener.open('Yandex',True)
                webbrowser.open('https://rus.hitmotop.com')
                re('–û—Ç–∫—Ä—ã–≤–∞—é')

        elif '–æ—Ç–∫—Ä–æ–π –ø—Ä–æ–≤–æ–¥–Ω–∏–∫' in text:
            keyboard.send('Win + E')
            re('–ï—Å—Ç—å')

        elif '–¥–∞–ª—å—à–µ' in text:
            keyboard.send('shift + N')
            re('–ï—Å—Ç—å')

        elif '–ø—Ä–æ–±–µ–ª' in text:
            keyboard.send('space')
            re('–ï—Å—Ç—å')

        elif '–ø–æ–ª–Ω—ã–π —ç–∫—Ä–∞–Ω' in text:
            keyboard.send('F')
            re('–ï—Å—Ç—å')

        elif '–≤—Ä–µ–º—è' in text:
            current_time = datetime.now().strftime("%H:%M")
            re(f'–°–µ–π—á–∞—Å {current_time}')

        elif '–≤—Ä–µ–º–µ–Ω–∏' in text:
            current_time = datetime.now().strftime("%H:%M")
            re(f'–°–µ–π—á–∞—Å {current_time}')    

        elif '—Å–æ—Å—Ç–æ—è–Ω–∏–µ' in text or '–±–∞—Ç–∞—Ä–µ—è' in text:
            battery = psutil.sensors_battery()
            if battery.power_plugged:
                status = "–∑–∞—Ä—è–∂–∞–µ—Ç—Å—è"
            else:
                status = "—Ä–∞–±–æ—Ç–∞–µ—Ç –æ—Ç –±–∞—Ç–∞—Ä–µ–∏"
            re(f'–ë–∞—Ç–∞—Ä–µ—è {status}, —É—Ä–æ–≤–µ–Ω—å –∑–∞—Ä—è–¥–∞ {battery.percent}%')

        elif any(word in text for word in ['–≥—Ä–æ–º—á–µ', '—É–≤–µ–ª–∏—á—å –≥—Ä–æ–º–∫–æ—Å—Ç—å']):
            new_vol = change_volume('up')
            re(f'–ì—Ä–æ–º–∫–æ—Å—Ç—å —É–≤–µ–ª–∏—á–µ–Ω–∞ –¥–æ {int(new_vol * 100)}%')

        elif any(word in text for word in ['—Ç–∏—à–µ', '—É–º–µ–Ω—å—à–∏ –≥—Ä–æ–º–∫–æ—Å—Ç—å']):
            new_vol = change_volume('down')
            re(f'–ì—Ä–æ–º–∫–æ—Å—Ç—å —É–º–µ–Ω—å—à–µ–Ω–∞ –¥–æ {int(new_vol * 100)}%')

        elif '–≥—Ä–æ–º–∫–æ—Å—Ç—å' in text:
            try:
                vol_level = int(''.join(filter(str.isdigit, text)))
                vol_level = max(0, min(100, vol_level))
                if set_system_volume(vol_level / 100):
                    re(f'–£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –≥—Ä–æ–º–∫–æ—Å—Ç—å {vol_level}%')
            except:
                re('–°–∫–∞–∂–∏—Ç–µ, –Ω–∞–ø—Ä–∏–º–µ—Ä, "–ø–æ—Å—Ç–∞–≤—å –≥—Ä–æ–º–∫–æ—Å—Ç—å 50"')

        elif '–æ—Ç–∫—Ä–æ–π' in text:
            app = text.replace("–æ—Ç–∫—Ä–æ–π", "").strip()
            if app:
                try:
                    AppOpener.open(app,match_closest=True)
                    re(f'–û—Ç–∫—Ä—ã–≤–∞—é {app}')
                except:
                    re(f'–ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–∫—Ä—ã—Ç—å {app}')
            else:
                re('–ö–∞–∫–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –æ—Ç–∫—Ä—ã—Ç—å?')

        elif '–∞–Ω–µ–∫–¥–æ—Ç' in text:
            re(random.choice(jokes))

        elif '–∑–∞–∫—Ä–æ–π' in text:
            app = text.replace("–∑–∞–∫—Ä–æ–π", "").strip()
            if app:
                try:
                    AppOpener.close(app,match_closest=True)
                    re(f'–ó–∞–∫—Ä—ã–≤–∞—é {app}')
                except:
                    re(f'–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–∫—Ä—ã—Ç—å {app}')
            else:
                re('–ö–∞–∫–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–∫—Ä—ã—Ç—å?')

        elif '–≤—ã–∫–ª—é—á–∏ –∫–æ–º–ø—å—é—Ç–µ—Ä' in text:
            re('–í—ã–∫–ª—é—á–∞—é –∫–æ–º–ø—å—é—Ç–µ—Ä —á–µ—Ä–µ–∑ 10 —Å–µ–∫—É–Ω–¥')
            os.system("shutdown /s /t 10")

        else:
            ans = gig.ask_gigachat(text)
            ans = ans.replace('*', '')
            ans = ans.replace('%', '')
            ans = ans.replace('$', '')
            re(ans)

    except Exception as e:
        re('–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –∫–æ–º–∞–Ω–¥—ã')
        print(f"–û—à–∏–±–∫–∞: {e}")

def main():
    """–û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è"""
    print("\033[1;32m" + ' üöÄ –ì–æ–ª–æ—Å–æ–≤–æ–π –ø–æ–º–æ—â–Ω–∏–∫ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω üöÄ' + "\033[0m")
    print("–î–ª—è –≤—ã—Ö–æ–¥–∞ —Å–∫–∞–∂–∏—Ç–µ –∫–µ—à–∞ –ø–æ–∫–∞/—Å—Ç–æ–ø/–≤—ã—Ö–æ–¥")
    print("–î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:")

    print("- –ü—Ä–∏–≤–µ—Ç/–ú–æ–ª–æ–¥–µ—Ü/–ö–∞–∫ –¥–µ–ª–∞")
    print("- –ú—ã–∑—ã–∫–∞/–ú—É–∑—ã–∫–∞ [–Ω–∞–∑–≤–∞–Ω–∏–µ]")
    print("- –ü–æ—Å—Ç–∞–≤—å —Ç–∞–π–º–µ—Ä –Ω–∞ [–º–∏–Ω—É—Ç]")
    print("- –í–∫–ª—é—á–∏ —Å–≤–µ—Ç/–í—ã–∫–ª—é—á–∏ —Å–≤–µ—Ç (–î–ª—è —Ç–µ—Ö —É –∫–æ–≥–æ –µ—Å—Ç—å —É–º–Ω—ã–π –¥–æ–º –∞–ª–∏—Å–æ–π)")
    print("- –ü–µ—Ä–µ–≤–µ–¥–∏ –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–∏–π [—Å–ª–æ–≤–æ]")
    print("- –î–∞–ª—å—à–µ/–ü–∞—É–∑–∞")
    print("- –ù–∞–π–¥–∏ –≤ —é—Ç—É–±–µ [–∑–∞–ø—Ä–æ—Å]")
    print("- –ù–∞–π–¥–∏ [–∑–∞–ø—Ä–æ—Å]")
    print("- –û—Ç–∫—Ä–æ–π/–ó–∞–∫—Ä–æ–π [–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ] (–∏–Ω–æ–≥–¥–∞ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç)-")
    print("- –ü–æ–≥–æ–¥–∞")
    print("- –ü–µ—Ä–µ–≤–æ–¥—á–∏–∫")
    print("- –í—Ä–µ–º—è")
    print("- –°–æ—Å—Ç–æ—è–Ω–∏–µ –±–∞—Ç–∞—Ä–µ–∏")
    print("- –ì—Ä–æ–º—á–µ/–¢–∏—à–µ")
    print("- –ì—Ä–æ–º–∫–æ—Å—Ç—å [–≥—Ä–æ–º–∫–æ—Å—Ç—å –æ—Ç 1 –¥–æ 100]")
    print("- –í—ã–∫–ª—é—á–∏ –∫–æ–º–ø—å—é—Ç–µ—Ä")

    print("–î–æ—Å—Ç—É–ø–Ω—ã–µ –∏–≥—Ä—ã:")

    print("–ß—Ç–æ –±—ã –Ω–∞—á–∞—Ç—å –∏–≥—Ä—É —Å–∫–∞–∂–∏—Ç–µ –ö–µ—à–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∏–≥—Ä—ã")

    print("- –ò–≥—Ä—ã - –û—Ç–∫—Ä—ã–≤–∞–µ—Ç —è–Ω–¥–µ–∫—Å –∏–≥—Ä—ã")
    print("- FIreKill (–ü–æ–∏–≥—Ä–∞–π—Ç–µ –æ—á–µ–Ω—å –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ =) - ")
    print("- –í–∏—Å–µ–ª–∏—Ü–∞ - ")
    print("- –ö—Ä–µ—Å—Ç–∏–∫–∏-–ù–æ–ª–∏–∫–∏ - ")
    print("- –£–≥–∞–¥–∞–π —á–∏—Å–ª–æ - ")
    print("- –ö–≤–µ—Å—Ç - ")
    print("- –í–∏–∫—Ç–æ—Ä–∏–Ω–∞ - ")
    print("- –ö–∞–º–µ–Ω—å –Ω–æ–∂–Ω–∏—Ü—ã –±—É–º–∞–≥–∞ - ")
    print("- –£–≥–∞–¥–∞–π —á–∏—Å–ª–æ - ")

    # –ó–∞–ø—É—Å–∫ –ø–æ—Ç–æ–∫–æ–≤
    threading.Thread(target=listen_for_wake_word, daemon=True).start()
    threading.Thread(target=process_commands, daemon=True).start()

    try:
        while True:
            time.sleep(0.1)
    except KeyboardInterrupt:
        re("–í—ã–∫–ª—é—á–∞—é—Å—å")
        os._exit(0)

if __name__ == "__main__":
    main()
